<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>School Infrastructure Form</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <script>
    const schoolData = {
      "District A": ["School A1", "School A2", "School A3"],
      "District B": ["School B1", "School B2"],
      "District C": ["School C1", "School C2", "School C3"]
    };

    function loadDistricts() {
      const districtSelect = document.getElementById('district');
      districtSelect.innerHTML = '<option value="">--Select District--</option>';
      Object.keys(schoolData).forEach(district => {
        districtSelect.innerHTML += `<option value="${district}">${district}</option>`;
      });
    }

    function loadSchools() {
      const selectedDistrict = document.getElementById('district').value;
      const schoolSelect = document.getElementById('school');
      schoolSelect.innerHTML = '<option value="">--Select School--</option>';
      if (schoolData[selectedDistrict]) {
        schoolData[selectedDistrict].forEach(school => {
          schoolSelect.innerHTML += `<option value="${school}">${school}</option>`;
        });
      }
    }

    function updateTotal(i) {
      const boys = parseInt(document.getElementById(`boys${i}`).value) || 0;
      const girls = parseInt(document.getElementById(`girls${i}`).value) || 0;
      document.getElementById(`total${i}`).value = boys + girls;
    }

    function validateForm() {
      const requiredFields = ['district', 'school', 'udise', 'classrooms', 'benches'];
      for (let id of requiredFields) {
        if (!document.getElementById(id).value.trim()) {
          alert("Please fill all required fields.");
          return false;
        }
      }
      for (let i = 6; i <= 12; i++) {
        if (
          !document.getElementById(`boys${i}`).value.trim() ||
          !document.getElementById(`girls${i}`).value.trim()
        ) {
          alert(`Please fill boys and girls data for Class ${i}`);
          return false;
        }
      }
      return true;
    }

    function resetForm() {
      document.getElementById("infraForm").reset();
      loadDistricts();
      document.getElementById("school").innerHTML = '<option value="">--Select School--</option>';
      for (let i = 6; i <= 12; i++) {
        document.getElementById(`total${i}`).value = '';
      }
    }

    window.onload = loadDistricts;
  </script>
</head>
<body>
  <form id="infraForm" method="POST" onsubmit="return validateForm()">
    <h2>üìä School Infrastructure Form</h2>

    <label for="district">District:</label>
    <select id="district" name="district" onchange="loadSchools()" required></select>

    <label for="school">School:</label>
    <select id="school" name="school" required></select>

    <label for="udise">UDISE Code:</label>
    <input type="text" id="udise" name="udise" maxlength="11" placeholder="Enter 11-digit UDISE code" required>

    <label for="classrooms">Number of Classrooms:</label>
    <input type="number" id="classrooms" name="classrooms" min="0" required>

    <label for="benches">Benches per Classroom:</label>
    <input type="number" id="benches" name="benches" min="0" required>

    <h3>üë®‚Äçüè´ Students Per Class (6‚Äì12)</h3>
    <table>
      <tr><th>Class</th><th>Boys</th><th>Girls</th><th>Total</th></tr>
      <script>
        for (let i = 6; i <= 12; i++) {
          document.write(`
            <tr>
              <td>Class ${i}</td>
              <td><input type="number" id="boys${i}" name="boys${i}" min="0" oninput="updateTotal(${i})" required></td>
              <td><input type="number" id="girls${i}" name="girls${i}" min="0" oninput="updateTotal(${i})" required></td>
              <td><input type="number" id="total${i}" name="total${i}" readonly style="background-color:#f0f0f0;"></td>
            </tr>
          `);
        }
      </script>
    </table>

    <button type="submit">Submit</button>
    <button type="button" onclick="resetForm()" style="background-color: #bdc3c7;">Reset</button>
  </form>
</body>
</html>
